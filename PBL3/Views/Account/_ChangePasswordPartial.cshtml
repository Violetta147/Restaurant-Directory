@model PBL3.ViewModels.ChangePasswordViewModel

<div class="card-body">
    @if (!string.IsNullOrEmpty(Model?.StatusMessage))
    {
        <div class="alert @(Model.StatusMessage.Contains("Lỗi") ? "alert-danger" : "alert-success") alert-dismissible fade show" role="alert">
            @Model.StatusMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <form asp-controller="Account" asp-action="ChangePassword" method="post" id="changePasswordForm">
        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>
        
        <div class="mb-3">
            <label asp-for="CurrentPassword" class="form-label"></label>
            <div class="input-group">
                <input asp-for="CurrentPassword" class="form-control" />
                <button type="button" class="btn btn-outline-secondary toggle-password" data-target="CurrentPassword">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <span asp-validation-for="CurrentPassword" class="text-danger"></span>
        </div>
        
        <div class="mb-3">
            <label asp-for="NewPassword" class="form-label"></label>
            <div class="input-group">
                <input asp-for="NewPassword" class="form-control" />
                <button type="button" class="btn btn-outline-secondary toggle-password" data-target="NewPassword">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <span asp-validation-for="NewPassword" class="text-danger"></span>
        </div>
        
        <div class="mb-3">
            <label asp-for="ConfirmPassword" class="form-label"></label>
            <div class="input-group">
                <input asp-for="ConfirmPassword" class="form-control" />
                <button type="button" class="btn btn-outline-secondary toggle-password" data-target="ConfirmPassword">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
        </div>

        <div class="d-grid">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-key me-2"></i>Đổi mật khẩu
            </button>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.toggle-password').forEach(button => {
            button.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const input = document.getElementById(targetId);
                
                if (input.type === 'password') {
                    input.type = 'text';
                    this.querySelector('i').classList.replace('fa-eye', 'fa-eye-slash');
                } else {
                    input.type = 'password';
                    this.querySelector('i').classList.replace('fa-eye-slash', 'fa-eye');
                }
            });
        });
    });
</script>
